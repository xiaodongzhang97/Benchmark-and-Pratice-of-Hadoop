
Logging initialized using configuration in jar:file:/home/zhangxiaodong/HiBench-master/hadoopbench/sql/target/apache-hive-0.14.0-bin/lib/hive-common-0.14.0.jar!/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/zhangxiaodong/hadoop-2.4.0/share/hadoop/common/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/zhangxiaodong/HiBench-master/hadoopbench/sql/target/apache-hive-0.14.0-bin/lib/hive-jdbc-0.14.0-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
OK
Time taken: 0.776 seconds
OK
Time taken: 0.123 seconds
OK
Time taken: 0.768 seconds
OK
Time taken: 0.09 seconds
OK
Time taken: 0.117 seconds
OK
Time taken: 0.032 seconds
OK
Time taken: 0.264 seconds
Query ID = zhangxiaodong_20190106024444_641bbfe7-0822-4ac1-90f9-1fbed20116b2
Total jobs = 2
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/zhangxiaodong/hadoop-2.4.0/share/hadoop/common/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/zhangxiaodong/HiBench-master/hadoopbench/sql/target/apache-hive-0.14.0-bin/lib/hive-jdbc-0.14.0-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
19/01/06 02:44:20 WARN conf.Configuration: file:/tmp/zhangxiaodong/e4f2b503-d7fe-4d9f-9cc5-c6aab586696e/hive_2019-01-06_02-44-11_391_2583642461052875108-1/-local-10007/jobconf.xml:an attempt to override final parameter: mapreduce.job.end-notification.max.retry.interval;  Ignoring.
19/01/06 02:44:20 WARN conf.Configuration: file:/tmp/zhangxiaodong/e4f2b503-d7fe-4d9f-9cc5-c6aab586696e/hive_2019-01-06_02-44-11_391_2583642461052875108-1/-local-10007/jobconf.xml:an attempt to override final parameter: mapreduce.job.end-notification.max.attempts;  Ignoring.
Execution log at: /tmp/zhangxiaodong/zhangxiaodong_20190106024444_641bbfe7-0822-4ac1-90f9-1fbed20116b2.log
2019-01-06 02:44:22	Starting to launch local task to process map join;	maximum memory = 518979584
2019-01-06 02:44:25	Dump the side-table for tag: 0 with group count: 120 into file: file:/tmp/zhangxiaodong/e4f2b503-d7fe-4d9f-9cc5-c6aab586696e/hive_2019-01-06_02-44-11_391_2583642461052875108-1/-local-10004/HashTable-Stage-2/MapJoin-mapfile00--.hashtable
2019-01-06 02:44:25	Uploaded 1 File to: file:/tmp/zhangxiaodong/e4f2b503-d7fe-4d9f-9cc5-c6aab586696e/hive_2019-01-06_02-44-11_391_2583642461052875108-1/-local-10004/HashTable-Stage-2/MapJoin-mapfile00--.hashtable (9476 bytes)
2019-01-06 02:44:25	End of local task; Time Taken: 3.203 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 2
Number of reduce tasks not specified. Defaulting to jobconf value of: 32
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1546761780464_0023, Tracking URL = http://hadoop1:8088/proxy/application_1546761780464_0023/
Kill Command = /home/zhangxiaodong/hadoop-2.4.0/bin/hadoop job  -kill job_1546761780464_0023
Hadoop job information for Stage-2: number of mappers: 42; number of reducers: 32
2019-01-06 02:44:43,701 Stage-2 map = 0%,  reduce = 0%
2019-01-06 02:46:33,281 Stage-2 map = 2%,  reduce = 0%, Cumulative CPU 5.16 sec
2019-01-06 02:46:57,302 Stage-2 map = 9%,  reduce = 0%, Cumulative CPU 12.05 sec
2019-01-06 02:47:40,353 Stage-2 map = 18%,  reduce = 0%, Cumulative CPU 29.35 sec
2019-01-06 02:47:44,758 Stage-2 map = 21%,  reduce = 0%, Cumulative CPU 47.03 sec
2019-01-06 02:48:07,760 Stage-2 map = 31%,  reduce = 0%, Cumulative CPU 70.93 sec
2019-01-06 02:48:35,716 Stage-2 map = 33%,  reduce = 0%, Cumulative CPU 74.89 sec
2019-01-06 02:49:35,776 Stage-2 map = 33%,  reduce = 0%, Cumulative CPU 74.89 sec
2019-01-06 02:50:11,116 Stage-2 map = 33%,  reduce = 1%, Cumulative CPU 77.5 sec
2019-01-06 02:50:15,293 Stage-2 map = 36%,  reduce = 1%, Cumulative CPU 83.16 sec
2019-01-06 02:50:16,335 Stage-2 map = 38%,  reduce = 1%, Cumulative CPU 83.68 sec
2019-01-06 02:50:19,477 Stage-2 map = 38%,  reduce = 2%, Cumulative CPU 83.94 sec
2019-01-06 02:50:21,558 Stage-2 map = 43%,  reduce = 2%, Cumulative CPU 90.66 sec
2019-01-06 02:50:39,663 Stage-2 map = 48%,  reduce = 2%, Cumulative CPU 105.84 sec
2019-01-06 02:50:40,698 Stage-2 map = 50%,  reduce = 2%, Cumulative CPU 107.53 sec
2019-01-06 02:50:41,782 Stage-2 map = 52%,  reduce = 2%, Cumulative CPU 109.22 sec
2019-01-06 02:50:43,861 Stage-2 map = 55%,  reduce = 2%, Cumulative CPU 110.96 sec
2019-01-06 02:50:44,895 Stage-2 map = 57%,  reduce = 2%, Cumulative CPU 112.55 sec
2019-01-06 02:50:46,964 Stage-2 map = 60%,  reduce = 2%, Cumulative CPU 114.81 sec
2019-01-06 02:50:49,053 Stage-2 map = 62%,  reduce = 2%, Cumulative CPU 116.73 sec
2019-01-06 02:50:50,108 Stage-2 map = 62%,  reduce = 3%, Cumulative CPU 116.93 sec
2019-01-06 02:50:58,608 Stage-2 map = 62%,  reduce = 4%, Cumulative CPU 118.46 sec
2019-01-06 02:51:29,712 Stage-2 map = 62%,  reduce = 5%, Cumulative CPU 123.19 sec
2019-01-06 02:52:16,892 Stage-2 map = 64%,  reduce = 5%, Cumulative CPU 142.5 sec
2019-01-06 02:52:18,958 Stage-2 map = 67%,  reduce = 5%, Cumulative CPU 143.51 sec
2019-01-06 02:52:23,087 Stage-2 map = 71%,  reduce = 5%, Cumulative CPU 146.95 sec
2019-01-06 02:52:25,157 Stage-2 map = 74%,  reduce = 5%, Cumulative CPU 153.55 sec
2019-01-06 02:52:26,190 Stage-2 map = 76%,  reduce = 5%, Cumulative CPU 153.97 sec
2019-01-06 02:52:27,211 Stage-2 map = 79%,  reduce = 5%, Cumulative CPU 155.1 sec
2019-01-06 02:52:36,481 Stage-2 map = 79%,  reduce = 6%, Cumulative CPU 156.34 sec
2019-01-06 02:53:37,332 Stage-2 map = 79%,  reduce = 6%, Cumulative CPU 162.29 sec
2019-01-06 02:53:49,705 Stage-2 map = 80%,  reduce = 6%, Cumulative CPU 166.66 sec
2019-01-06 02:53:52,800 Stage-2 map = 81%,  reduce = 6%, Cumulative CPU 167.01 sec
2019-01-06 02:54:06,184 Stage-2 map = 83%,  reduce = 6%, Cumulative CPU 176.19 sec
2019-01-06 02:54:13,912 Stage-2 map = 86%,  reduce = 6%, Cumulative CPU 180.63 sec
2019-01-06 02:54:20,205 Stage-2 map = 88%,  reduce = 6%, Cumulative CPU 184.78 sec
2019-01-06 02:54:21,232 Stage-2 map = 90%,  reduce = 6%, Cumulative CPU 186.58 sec
2019-01-06 02:54:22,260 Stage-2 map = 93%,  reduce = 6%, Cumulative CPU 188.34 sec
2019-01-06 02:54:23,291 Stage-2 map = 95%,  reduce = 6%, Cumulative CPU 191.48 sec
2019-01-06 02:54:24,314 Stage-2 map = 95%,  reduce = 7%, Cumulative CPU 191.66 sec
2019-01-06 02:54:50,178 Stage-2 map = 95%,  reduce = 8%, Cumulative CPU 194.26 sec
2019-01-06 02:54:56,388 Stage-2 map = 98%,  reduce = 8%, Cumulative CPU 198.93 sec
2019-01-06 02:54:57,451 Stage-2 map = 100%,  reduce = 8%, Cumulative CPU 199.54 sec
2019-01-06 02:54:58,537 Stage-2 map = 100%,  reduce = 11%, Cumulative CPU 199.98 sec
2019-01-06 02:54:59,576 Stage-2 map = 100%,  reduce = 13%, Cumulative CPU 200.44 sec
2019-01-06 02:55:00,609 Stage-2 map = 100%,  reduce = 19%, Cumulative CPU 202.36 sec
2019-01-06 02:55:01,663 Stage-2 map = 100%,  reduce = 23%, Cumulative CPU 205.7 sec
2019-01-06 02:55:02,718 Stage-2 map = 100%,  reduce = 25%, Cumulative CPU 207.47 sec
2019-01-06 02:55:09,957 Stage-2 map = 100%,  reduce = 26%, Cumulative CPU 211.58 sec
2019-01-06 02:55:10,985 Stage-2 map = 100%,  reduce = 29%, Cumulative CPU 215.07 sec
2019-01-06 02:55:12,116 Stage-2 map = 100%,  reduce = 31%, Cumulative CPU 217.48 sec
2019-01-06 02:55:13,176 Stage-2 map = 100%,  reduce = 32%, Cumulative CPU 218.57 sec
2019-01-06 02:55:14,250 Stage-2 map = 100%,  reduce = 33%, Cumulative CPU 219.56 sec
2019-01-06 02:55:15,281 Stage-2 map = 100%,  reduce = 36%, Cumulative CPU 223.16 sec
2019-01-06 02:55:16,388 Stage-2 map = 100%,  reduce = 38%, Cumulative CPU 224.32 sec
2019-01-06 02:55:33,161 Stage-2 map = 100%,  reduce = 40%, Cumulative CPU 226.47 sec
2019-01-06 02:55:34,200 Stage-2 map = 100%,  reduce = 42%, Cumulative CPU 227.57 sec
2019-01-06 02:55:41,558 Stage-2 map = 100%,  reduce = 44%, Cumulative CPU 228.48 sec
2019-01-06 02:55:45,699 Stage-2 map = 100%,  reduce = 46%, Cumulative CPU 229.97 sec
2019-01-06 02:55:46,751 Stage-2 map = 100%,  reduce = 47%, Cumulative CPU 231.55 sec
2019-01-06 02:55:48,809 Stage-2 map = 100%,  reduce = 48%, Cumulative CPU 233.76 sec
2019-01-06 02:55:49,860 Stage-2 map = 100%,  reduce = 50%, Cumulative CPU 234.66 sec
2019-01-06 02:55:51,917 Stage-2 map = 100%,  reduce = 52%, Cumulative CPU 235.57 sec
2019-01-06 02:55:52,956 Stage-2 map = 100%,  reduce = 53%, Cumulative CPU 237.36 sec
2019-01-06 02:55:53,991 Stage-2 map = 100%,  reduce = 55%, Cumulative CPU 238.28 sec
2019-01-06 02:55:55,017 Stage-2 map = 100%,  reduce = 57%, Cumulative CPU 239.81 sec
2019-01-06 02:55:57,091 Stage-2 map = 100%,  reduce = 58%, Cumulative CPU 241.63 sec
2019-01-06 02:56:00,173 Stage-2 map = 100%,  reduce = 59%, Cumulative CPU 243.38 sec
2019-01-06 02:56:02,255 Stage-2 map = 100%,  reduce = 60%, Cumulative CPU 244.48 sec
2019-01-06 02:56:03,290 Stage-2 map = 100%,  reduce = 62%, Cumulative CPU 245.15 sec
2019-01-06 02:56:04,317 Stage-2 map = 100%,  reduce = 64%, Cumulative CPU 246.24 sec
2019-01-06 02:56:05,363 Stage-2 map = 100%,  reduce = 65%, Cumulative CPU 247.45 sec
2019-01-06 02:56:07,429 Stage-2 map = 100%,  reduce = 69%, Cumulative CPU 249.28 sec
2019-01-06 02:56:09,498 Stage-2 map = 100%,  reduce = 71%, Cumulative CPU 249.95 sec
2019-01-06 02:56:10,531 Stage-2 map = 100%,  reduce = 73%, Cumulative CPU 250.61 sec
2019-01-06 02:56:11,562 Stage-2 map = 100%,  reduce = 75%, Cumulative CPU 252.15 sec
2019-01-06 02:56:19,857 Stage-2 map = 100%,  reduce = 76%, Cumulative CPU 254.95 sec
2019-01-06 02:56:22,954 Stage-2 map = 100%,  reduce = 77%, Cumulative CPU 256.4 sec
2019-01-06 02:56:24,036 Stage-2 map = 100%,  reduce = 78%, Cumulative CPU 257.88 sec
2019-01-06 02:56:26,148 Stage-2 map = 100%,  reduce = 80%, Cumulative CPU 260.96 sec
2019-01-06 02:56:27,175 Stage-2 map = 100%,  reduce = 83%, Cumulative CPU 263.87 sec
2019-01-06 02:56:30,272 Stage-2 map = 100%,  reduce = 85%, Cumulative CPU 265.26 sec
2019-01-06 02:56:32,344 Stage-2 map = 100%,  reduce = 89%, Cumulative CPU 267.87 sec
2019-01-06 02:56:33,390 Stage-2 map = 100%,  reduce = 94%, Cumulative CPU 272.01 sec
2019-01-06 02:56:34,428 Stage-2 map = 100%,  reduce = 96%, Cumulative CPU 274.2 sec
2019-01-06 02:56:35,511 Stage-2 map = 100%,  reduce = 98%, Cumulative CPU 276.03 sec
2019-01-06 02:56:37,572 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 278.08 sec
MapReduce Total cumulative CPU time: 4 minutes 38 seconds 80 msec
Ended Job = job_1546761780464_0023
Launching Job 2 out of 2
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1546761780464_0024, Tracking URL = http://hadoop1:8088/proxy/application_1546761780464_0024/
Kill Command = /home/zhangxiaodong/hadoop-2.4.0/bin/hadoop job  -kill job_1546761780464_0024
Hadoop job information for Stage-3: number of mappers: 32; number of reducers: 1
2019-01-06 02:57:04,396 Stage-3 map = 0%,  reduce = 0%
2019-01-06 02:57:43,011 Stage-3 map = 3%,  reduce = 0%, Cumulative CPU 1.52 sec
2019-01-06 02:57:52,781 Stage-3 map = 19%,  reduce = 0%, Cumulative CPU 10.01 sec
2019-01-06 02:57:59,840 Stage-3 map = 22%,  reduce = 0%, Cumulative CPU 11.59 sec
2019-01-06 02:58:01,439 Stage-3 map = 25%,  reduce = 0%, Cumulative CPU 15.86 sec
2019-01-06 02:58:02,574 Stage-3 map = 28%,  reduce = 0%, Cumulative CPU 17.0 sec
2019-01-06 02:58:07,862 Stage-3 map = 31%,  reduce = 0%, Cumulative CPU 17.32 sec
2019-01-06 02:58:11,285 Stage-3 map = 34%,  reduce = 0%, Cumulative CPU 19.07 sec
2019-01-06 02:58:29,740 Stage-3 map = 38%,  reduce = 0%, Cumulative CPU 20.71 sec
2019-01-06 02:58:33,031 Stage-3 map = 43%,  reduce = 0%, Cumulative CPU 23.45 sec
2019-01-06 02:58:34,129 Stage-3 map = 44%,  reduce = 0%, Cumulative CPU 23.55 sec
2019-01-06 02:58:40,543 Stage-3 map = 47%,  reduce = 0%, Cumulative CPU 24.96 sec
2019-01-06 02:58:41,602 Stage-3 map = 50%,  reduce = 0%, Cumulative CPU 26.32 sec
2019-01-06 02:58:43,775 Stage-3 map = 53%,  reduce = 0%, Cumulative CPU 27.84 sec
2019-01-06 02:58:45,891 Stage-3 map = 56%,  reduce = 0%, Cumulative CPU 29.34 sec
2019-01-06 02:59:12,358 Stage-3 map = 59%,  reduce = 0%, Cumulative CPU 30.78 sec
2019-01-06 02:59:15,541 Stage-3 map = 63%,  reduce = 0%, Cumulative CPU 32.4 sec
2019-01-06 02:59:17,734 Stage-3 map = 66%,  reduce = 0%, Cumulative CPU 34.05 sec
2019-01-06 02:59:23,007 Stage-3 map = 68%,  reduce = 0%, Cumulative CPU 35.5 sec
2019-01-06 02:59:24,060 Stage-3 map = 72%,  reduce = 0%, Cumulative CPU 37.18 sec
2019-01-06 02:59:25,090 Stage-3 map = 72%,  reduce = 22%, Cumulative CPU 37.84 sec
2019-01-06 02:59:26,156 Stage-3 map = 78%,  reduce = 22%, Cumulative CPU 40.85 sec
2019-01-06 02:59:27,206 Stage-3 map = 91%,  reduce = 22%, Cumulative CPU 46.85 sec
2019-01-06 02:59:28,235 Stage-3 map = 91%,  reduce = 27%, Cumulative CPU 46.97 sec
2019-01-06 02:59:30,296 Stage-3 map = 97%,  reduce = 27%, Cumulative CPU 50.27 sec
2019-01-06 02:59:31,331 Stage-3 map = 100%,  reduce = 30%, Cumulative CPU 51.77 sec
2019-01-06 02:59:34,433 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 53.37 sec
MapReduce Total cumulative CPU time: 53 seconds 370 msec
Ended Job = job_1546761780464_0024
Loading data to table default.rankings_uservisits_join
MapReduce Jobs Launched:
Stage-Stage-2: Map: 42  Reduce: 32   Cumulative CPU: 278.08 sec   HDFS Read: 212843 HDFS Write: 4295 SUCCESS
Stage-Stage-3: Map: 32  Reduce: 1   Cumulative CPU: 53.37 sec   HDFS Read: 17383 HDFS Write: 1166 SUCCESS
Total MapReduce CPU Time Spent: 5 minutes 31 seconds 450 msec
OK
Time taken: 926.59 seconds
